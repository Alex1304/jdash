(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[988],{9970:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return r},metadata:function(){return d},toc:function(){return p},default:function(){return v}});var a=n(2122),l=n(9756),o=(n(7294),n(3905)),s=n(1395),i=n(8215),r={title:"JDash Events"},d={unversionedId:"jdash-events",id:"jdash-events",isDocsHomePage:!1,title:"JDash Events",description:"This section will cover the features of the JDash Events module.",source:"@site/docs/jdash-events.md",sourceDirName:".",slug:"/jdash-events",permalink:"/jdash-events",editUrl:"https://github.com/Alex1304/jdash/edit/master/website/docs/jdash-events.md",version:"current",frontMatter:{title:"JDash Events"},sidebar:"someSidebar",previous:{title:"JDash Client",permalink:"/jdash-client"},next:{title:"JDash Graphics",permalink:"/jdash-graphics"}},p=[{value:"Installation",id:"installation",children:[]},{value:"The event loop",id:"the-event-loop",children:[{value:"Starting an event loop with default parameters",id:"starting-an-event-loop-with-default-parameters",children:[]},{value:"Building a custom event loop",id:"building-a-custom-event-loop",children:[]},{value:"Subscribing to events",id:"subscribing-to-events",children:[]},{value:"Stopping an event loop",id:"stopping-an-event-loop",children:[]}]}],u={toc:p};function v(e){var t=e.components,n=(0,l.Z)(e,["components"]);return(0,o.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"This section will cover the features of the JDash Events module."),(0,o.kt)("h2",{id:"installation"},"Installation"),(0,o.kt)("p",null,"Add the Maven or Gradle dependency to your project as described below:"),(0,o.kt)(s.Z,{groupId:"build-tools",defaultValue:"maven",values:[{label:"Maven",value:"maven"},{label:"Gradle",value:"gradle"}],mdxType:"Tabs"},(0,o.kt)(i.Z,{value:"maven",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-xml"},"<dependency>\n    <groupId>com.alex1304.jdash</groupId>\n    <artifactId>jdash-events</artifactId>\n    <version>${version}</version> \x3c!-- replace with latest version --\x3e\n</dependency>\n"))),(0,o.kt)(i.Z,{value:"gradle",mdxType:"TabItem"},(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-groovy"},"repositories {\n    mavenCentral()\n}\n\ndependencies {\n    // Replace ${version} with latest version\n    implementation 'com.alex1304.jdash:jdash-events:${version}'\n}\n")))),(0,o.kt)("h2",{id:"the-event-loop"},"The event loop"),(0,o.kt)("p",null,"An event loop is a task that runs in the background that will repeat some identical requests at regular intervals, and emit events in response to something that is detected when comparing the results of those repeated requests. JDash provides an event loop that allows to perform specific requests using the client in order to emit events such as new rated levels or Daily level changes."),(0,o.kt)("h3",{id:"starting-an-event-loop-with-default-parameters"},"Starting an event loop with default parameters"),(0,o.kt)("p",null,"Very simple:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"GDClient client = GDClient.create();\n\nGDEventLoop eventLoop = GDEventLoop.startWithDefaults(client);\n")),(0,o.kt)("p",null,"This starts an event loop with the following default characteristics:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Produces events related to changes in the Awarded category and changes in the Daily level/Weekly demon"),(0,o.kt)("li",{parentName:"ul"},"A default interval of 1 minute: the loop will repeat requests every 1 minute"),(0,o.kt)("li",{parentName:"ul"},"Emits events on ",(0,o.kt)("inlineCode",{parentName:"li"},"Schedulers.boundedElastic()"))),(0,o.kt)("h3",{id:"building-a-custom-event-loop"},"Building a custom event loop"),(0,o.kt)("p",null,"It is possible to customize the event loop using the builder:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},"GDEventLoop customLoop = GDEventLoop.builder(client)\n        .setEventProducers(Set.of(GDEventProducer.awardedLevels()))\n        .setInterval(Duration.ofSeconds(15))\n        .setScheduler(Schedulers.immediate())\n        .buildAndStart();\n")),(0,o.kt)("p",null,"Here we are building a loop that only produces events related to awarded levels; it won't make requests for Daily levels and Weekly demons. It will make requests every 15 seconds and will emit events on ",(0,o.kt)("inlineCode",{parentName:"p"},"Schedulers.immediate()"),"."),(0,o.kt)("h3",{id:"subscribing-to-events"},"Subscribing to events"),(0,o.kt)("p",null,"Use ",(0,o.kt)("inlineCode",{parentName:"p"},"eventLoop.on(type)")," to subscribe to the event flux:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-java"},'eventLoop.on(AwardedAdd.class)\n        .subscribe(event -> System.out.println("New level rated: "\n                + event.addedLevel().name()));\n\neventLoop.on(AwardedRemove.class)\n        .subscribe(event -> System.out.println("Level unrated: "\n                + event.removedLevel().name()));\n\neventLoop.on(AwardedUpdate.class)\n        .subscribe(event -> System.out.println("Level rating changed. Before: "\n                + event.oldData() + " - After: " + event.newData()));\n\neventLoop.on(DailyLevelChange.class)\n        .subscribe(event -> System.out.println("New Daily level: "\n                + event.after().name()));\n\neventLoop.on(WeeklyDemonChange.class)\n        .subscribe(event -> System.out.println("New Weekly demon: "\n                + event.after().name()));\n')),(0,o.kt)("h3",{id:"stopping-an-event-loop"},"Stopping an event loop"),(0,o.kt)("p",null,"Just invoke ",(0,o.kt)("inlineCode",{parentName:"p"},"eventLoop.stop()"),". The event loop instance will stop making requests and will terminate all current subscriptions to ",(0,o.kt)("inlineCode",{parentName:"p"},"eventLoop.on(type)"),"."))}v.isMDXComponent=!0}}]);